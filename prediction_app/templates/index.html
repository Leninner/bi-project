<!DOCTYPE html>
<html lang="es">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Análisis de Pobreza - Sistema de IA Predictivo</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	<link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>

<body>
	<div class="container-fluid">
		<!-- Header -->
		<header class="bg-primary text-white py-4 mb-4">
			<div class="container">
				<div class="row align-items-center">
					<div class="col-md-8">
						<h1 class="mb-0">
							<i class="fas fa-chart-line me-3"></i>
							Sistema de Análisis de Pobreza
						</h1>
						<p class="mb-0 mt-2">Análisis predictivo y comprensivo de indicadores de pobreza</p>
					</div>
					<div class="col-md-4 text-end">
						<div class="health-status">
							<i class="fas fa-circle text-success me-2"></i>
							<span id="status-text">Sistema Activo</span>
						</div>
					</div>
				</div>
			</div>
		</header>

		<div class="container">
			<!-- Main Content -->
			<div class="row">
				<!-- Upload Section -->
				<div class="col-lg-8">
					<div class="card shadow-sm mb-4">
						<div class="card-header bg-light">
							<h5 class="mb-0">
								<i class="fas fa-upload me-2"></i>
								Cargar Datos para Análisis
							</h5>
						</div>
						<div class="card-body">
							<!-- File Upload Form -->
							<form id="uploadForm" enctype="multipart/form-data">
								<div class="mb-4">
									<label for="fileInput" class="form-label">
										<strong>Seleccionar Archivo Excel o CSV</strong>
									</label>
									<div class="upload-area" id="uploadArea">
										<div class="upload-content">
											<i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
											<p class="mb-2">Arrastra y suelta tu archivo aquí</p>
											<p class="text-muted small">o haz clic para seleccionar (.xlsx, .xls, .csv)
											</p>
											<input type="file" id="fileInput" name="file" accept=".xlsx,.xls,.csv"
												class="d-none">
											<button type="button" class="btn btn-outline-primary"
												onclick="document.getElementById('fileInput').click()">
												Seleccionar Archivo
											</button>
										</div>
									</div>
									<div id="fileInfo" class="mt-3 d-none">
										<div class="alert alert-info">
											<i class="fas fa-file-excel me-2"></i>
											<span id="fileName"></span>
											<button type="button" class="btn btn-sm btn-outline-danger ms-2"
												onclick="clearFile()">
												<i class="fas fa-times"></i>
											</button>
										</div>
									</div>
								</div>

								<!-- Model Selection -->
								<div class="mb-4">
									<label for="modelType" class="form-label">
										<strong>Seleccionar Modelo</strong>
									</label>
									<select id="modelType" name="model_type" class="form-select">
										<option value="neural">Red Neuronal (Recomendado)</option>
										<option value="logistic">Modelo Logístico</option>
										<option value="linear">Modelo Lineal</option>
									</select>
									<div class="form-text">
										<i class="fas fa-info-circle me-1"></i>
										<span id="modelDescription">Red Neuronal: Análisis avanzado con alta
											precisión</span>
									</div>
								</div>

								<!-- Action Buttons -->
								<div class="d-flex gap-2">
									<button type="button" class="btn btn-outline-secondary" onclick="validateFile()">
										<i class="fas fa-check me-2"></i>
										Validar Archivo
									</button>
									<button type="submit" class="btn btn-primary" id="predictBtn" disabled>
										<i class="fas fa-magic me-2"></i>
										Realizar Análisis Completo
									</button>
									<button type="button" class="btn btn-outline-info" onclick="downloadTemplate()">
										<i class="fas fa-download me-2"></i>
										Descargar Plantilla
									</button>
								</div>
							</form>
						</div>
					</div>

					<!-- Data Analysis Section -->
					<div id="analysisSection" class="card shadow-sm mb-4 d-none">
						<div class="card-header bg-info text-white">
							<h5 class="mb-0">
								<i class="fas fa-chart-pie me-2"></i>
								Análisis de Datos
							</h5>
						</div>
						<div class="card-body">
							<!-- Data Quality Cards -->
							<div class="row mb-4" id="dataQualityCards">
								<!-- Data quality cards will be inserted here -->
							</div>

							<!-- Insights Section -->
							<div id="insightsSection" class="mb-4">
								<h6><i class="fas fa-lightbulb me-2"></i>Insights del Análisis</h6>
								<div id="insightsList">
									<!-- Insights will be inserted here -->
								</div>
							</div>

							<!-- Feature Importance -->
							<div id="featureImportanceSection" class="mb-4">
								<h6><i class="fas fa-star me-2"></i>Características Más Importantes</h6>
								<div id="featureImportanceList">
									<!-- Feature importance will be inserted here -->
								</div>
							</div>
						</div>
					</div>

					<!-- Results Section -->
					<div id="resultsSection" class="card shadow-sm mb-4 d-none">
						<div class="card-header bg-success text-white">
							<h5 class="mb-0">
								<i class="fas fa-chart-bar me-2"></i>
								Resultados de Predicción
							</h5>
						</div>
						<div class="card-body">
							<!-- Summary Cards -->
							<div class="row mb-4" id="summaryCards">
								<!-- Summary cards will be inserted here -->
							</div>

							<!-- Prediction Quality -->
							<div id="predictionQualitySection" class="mb-4">
								<h6><i class="fas fa-award me-2"></i>Calidad de Predicción</h6>
								<div id="predictionQualityInfo">
									<!-- Prediction quality info will be inserted here -->
								</div>
							</div>

							<!-- Recommendations -->
							<div id="recommendationsSection" class="mb-4">
								<h6><i class="fas fa-comments me-2"></i>Recomendaciones</h6>
								<div id="recommendationsList">
									<!-- Recommendations will be inserted here -->
								</div>
							</div>

							<!-- Results Table -->
							<div class="table-responsive">
								<table class="table table-striped table-hover" id="resultsTable">
									<thead class="table-dark">
										<tr>
											<th>ID Persona</th>
											<th>Predicción</th>
											<th>Estado</th>
											<th>Probabilidad</th>
											<th>Confianza</th>
											<th>Nivel Riesgo</th>
											<th>Modelo</th>
										</tr>
									</thead>
									<tbody id="resultsTableBody">
										<!-- Results will be inserted here -->
									</tbody>
								</table>
							</div>

							<!-- Export Buttons -->
							<div class="mt-3">
								<button type="button" class="btn btn-success" onclick="exportToExcel()">
									<i class="fas fa-file-excel me-2"></i>
									Exportar a Excel
								</button>
								<button type="button" class="btn btn-info" onclick="exportToCSV()">
									<i class="fas fa-file-csv me-2"></i>
									Exportar a CSV
								</button>
								<button type="button" class="btn btn-warning" onclick="exportAnalysisReport()">
									<i class="fas fa-file-pdf me-2"></i>
									Reporte Completo
								</button>
							</div>
						</div>
					</div>
				</div>

				<!-- Sidebar -->
				<div class="col-lg-4">
					<!-- Analysis Information -->
					<div class="card shadow-sm mb-4">
						<div class="card-header bg-info text-white">
							<h6 class="mb-0">
								<i class="fas fa-chart-pie me-2"></i>
								Capacidades de Análisis
							</h6>
						</div>
						<div class="card-body">
							<div class="mb-3">
								<h6 class="text-primary">
									<i class="fas fa-brain me-2"></i>
									Análisis Predictivo
								</h6>
								<p class="small text-muted">
									Predicción de pobreza usando modelos de machine learning avanzados con análisis de
									confianza.
								</p>
							</div>
							<div class="mb-3">
								<h6 class="text-success">
									<i class="fas fa-chart-line me-2"></i>
									Análisis de Datos
								</h6>
								<p class="small text-muted">
									Evaluación de calidad de datos, identificación de patrones y análisis estadístico
									completo.
								</p>
							</div>
							<div class="mb-3">
								<h6 class="text-warning">
									<i class="fas fa-exclamation-triangle me-2"></i>
									Evaluación de Riesgo
								</h6>
								<p class="small text-muted">
									Clasificación de riesgo de pobreza con niveles de confianza y recomendaciones
									específicas.
								</p>
							</div>
							<div class="mb-3">
								<h6 class="text-info">
									<i class="fas fa-star me-2"></i>
									Importancia de Características
								</h6>
								<p class="small text-muted">
									Identificación de las variables más importantes para la predicción de pobreza.
								</p>
							</div>
						</div>
					</div>

					<!-- Model Information -->
					<div class="card shadow-sm mb-4">
						<div class="card-header bg-secondary text-white">
							<h6 class="mb-0">
								<i class="fas fa-cogs me-2"></i>
								Información de Modelos
							</h6>
						</div>
						<div class="card-body">
							<div id="modelInfo">
								<!-- Model information will be loaded here -->
							</div>
						</div>
					</div>

					<!-- System Status -->
					<div class="card shadow-sm">
						<div class="card-header bg-dark text-white">
							<h6 class="mb-0">
								<i class="fas fa-server me-2"></i>
								Estado del Sistema
							</h6>
						</div>
						<div class="card-body">
							<div id="systemStatus">
								<!-- System status will be loaded here -->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Loading Modal -->
	<div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-body text-center">
					<div class="spinner-border text-primary mb-3" role="status">
						<span class="visually-hidden">Loading...</span>
					</div>
					<h5>Procesando Análisis</h5>
					<p class="text-muted">Esto puede tomar unos momentos...</p>
				</div>
			</div>
		</div>
	</div>

	<!-- Scripts -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>